<source>
    @type tail
    path /var/log/containers/microfrontend-hfhs-*.log
    pos_file /tmp/microfrontend-hfhs.log.pos
    time_format %Y-%m-%dT%H:%M:%S.%NZ
    tag hfhs.*
    format json
</source>

<source>
    @type tail
    path /var/log/containers/microfrontend-product-move-*.log
    pos_file /tmp/microfrontend-pm.log.pos
    time_format %Y-%m-%dT%H:%M:%S.%NZ
    tag hfhs.*
    format json
</source>

<source>
    @type tail
    path /var/log/containers/microfrontend-product-details-*.log
    pos_file /tmp/microfrontend-pd.log.pos
    time_format %Y-%m-%dT%H:%M:%S.%NZ
    tag hfhs.*
    format json
</source>

<source>
    @type tail
    path /var/log/containers/microfrontend-search-product-*.log
    pos_file /tmp/microfrontend-sp.log.pos
    time_format %Y-%m-%dT%H:%M:%S.%NZ
    tag hfhs.*
    format json
</source>

<filter hfhs.**>
    @type parser
    key_name log
    <parse>
        @type multi_format
        <pattern>
            format regexp
            expression /^\[(?<datetime>\d+\-\d+\-\d+T\d+\:\d+\:\d+\.\d+)\] \[(?<loglevel>\w+)\] (?<process>\w+) \- (?<tail>.*)/
        </pattern>
        <pattern>
            format none
        </pattern>
    </parse>
    reserve_data true
</filter>

<match hfhs.**>
    @type elasticsearch
    host elasticsearch.common
    port 9200
    logstash_format true
    logstash_prefix hfhs-fluentd
    flush_interval 10s
</match>